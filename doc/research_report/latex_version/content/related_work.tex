% Content: 相关工作
% Author: 刘时
% Update: 2025-03-22
\section{相关工作}

本项目作为计算机学院组成原理H班的大作业，完成了使用Rust改写RT-Thread国产loT操作系统内核的任务。下面将从本课程之前的Rust改写工作，国内外学术界和工业界的主流成果和本项目的创新点三个角度展开论述。

\subsection{本课程之前的Rust改写工作}

\begin{enumerate}
  \item 2019年 x-rust-freertos小组用Rust改写FreeRTOS（一个实时、嵌入式操作系统）,完成了对FreeRTOS中所有的内核模块——移植（port）模块、链表（list）模块、任务调度（task）模块和队列与信号量模块的改写。
  \item 2023年 Phoenix-Flames小组用Rust改写sel4微内核，提供内存安全性和并发安全性。
  \item 2024年 mustruct小组用Rust语言重写了FreeRTOS，并在其中引入了MMU支持，以期获得更灵活、安全的内存管理能力。
  \item 2024年 mkdir小组用Rust语言重写了Linux系统的bpf-trace模块，以期能更安全地监控和分析用户空间的程序行为。
  \item 2024年 Rage\_of\_dUST小组和RushToLight小组分别用Rust语言改写了Harmony LiteOS的内存管理单元（MMU）和动态内存管理模块，提升了系统的安全性和稳定性。
\end{enumerate}

\subsection{国内外学术界和工业界对Rust改写基于C的操作系统的讨论}

\subsubsection{在Linux内核中引入Rust语言}

近年来，业界对在Linux内核中引入Rust语言表现出浓厚兴趣，主要目的是利用Rust的内存安全特性来提高内核的安全性和稳定性。然而，将Rust完全替代C来重写整个Linux内核的想法并未得到广泛支持。

目前，社区的主要工作集中在将Rust引入内核的部分模块，特别是设备驱动程序的开发。2022年，首批Rust代码被合并到Linux内核中，标志着这一尝试的开始。此后，开发者们持续推进Rust在内核中的应用，例如开发基于Rust的设备驱动程序和文件系统模块。

一些核心维护者认为Rust的内存安全特性可以减少常见的内存管理错误，提高内核的安全性和可靠性。例如，Linux内核高级开发者Greg Kroah-Hartman曾表示，添加另一种语言并非问题，关键在于项目的长期成功。他强调，使用Rust编写新代码可以减少某些类型的错误，给开发者和维护者带来益处。

然而，也有部分维护者对在内核中使用Rust持保留态度，担心多语言代码库的维护复杂性和潜在问题。例如，内核维护者Christoph Hellwig对将Rust代码引入内核表示质疑，认为这可能增加维护负担。

对此，Linux之父Linus Torvalds也曾发表看法：Linux最终不会用Rust编写，没有人会用Rust重写内核的2500万行C代码，但是他也看到了Rust的优势，鼓励采用缓慢但稳定的方法将Rust引入Linux，同时他表示将Rust接口用于驱动程序和其他非核心内核程序是有道理的。

总体而言，业界对在Linux内核中引入Rust持谨慎支持态度，认可其潜在优势，但也关注可能带来的挑战。目前的共识是，在特定模块中试验性地引入Rust，以评估其实际效果和影响。

\subsubsection{在Windows内核中引入Rust语言}

微软对在Windows内核中引入Rust持积极态度，旨在利用Rust的内存安全特性减少漏洞，提高系统安全性和性能。然而，微软并未计划全面用Rust重写整个Windows内核，而是采取逐步迁移的策略。微软Azure首席技术官Mark Russinovich曾表示，新项目应优先考虑使用Rust，而非C/C++。

具体而言，微软将Windows的文本分析、布局和渲染引擎DWriteCore部分重写为Rust版本。截至2023年，DWriteCore包含约15.2万行Rust代码和9.6万行C++代码。两名开发人员耗时半年完成了这项工作，改进后的版本已面向开发者发布。同时，微软将Win32 GDI的部分组件迁移至Rust，目前已添加了约3.6万行Rust代码。这些改进已在最新版本的Windows 11中应用，并通过了所有启动测试。

\subsubsection{其他有关Rust改写的工作}

\paragraph{Redox \href{https://www.redox-os.org/zh/?utm_source=chatgpt.com}{[redox-os.org]}}

Redox 是一个用 Rust 编程语言编写的类 Unix 微内核操作系统，旨在将 Rust 的创新（安全性、并发性和实用性）引入现代微内核和完整的应用程序生态系统。

该系统采用微内核架构，类似于 MINIX，驱动程序在用户空间运行，增强了系统的安全性和稳定性。此外，Redox 包含可选的图形用户界面 Orbital，支持 Rust 标准库，并以 MIT 许可证开源发布。

Redox 的优势主要来源于 Rust 语言的特性：极高的内存管理安全性。此外，作为一个操作系统，其通过模块化和标准化实现了可拓展性与兼容性，已经能够成为一个实际的成果而非教学用例。但是，其作为新兴操作系统还存在功能不完善、硬件支持有限、稳定性欠佳等问题。

总体而言，Redox 作为一个创新的操作系统项目，展示了 Rust 在系统开发中的潜力。尽管目前存在一些不足，但其在安全性、模块化和兼容性方面的优势，使其有继续发展的潜力。

\paragraph{TockOS \href{https://tockos.org/}{[tockos.org]}}

TockOS 是一款专为嵌入式系统设计的开源实时操作系统，采用 Rust 编程语言编写内核，旨在为无线传感器网络节点等资源受限的设备提供安全、高效的运行环境。

TockOS 的主要优势同样来自 Rust 语言的特性：类型安全和内存管理安全。同时，作为一个嵌入式操作系统，其优化了低功耗特性，满足了嵌入式设备对能耗的敏感性。同样的，作为一个新兴的操作系统，TockOS 支持的硬件十分有限，生态系统还不成熟，同时，Rust 语言高昂的学习成本也限制了其广泛使用。

\paragraph{蓝河操作系统 \href{https://blueos.vivo.com/system}{[blueos.vivo.com]}}

蓝河操作系统（BlueOS）是 vivo 于 2023 年推出的自研智慧操作系统，采用 Rust 语言编写系统框架，旨在为用户提供更智慧、更流畅、更安全的使用体验。

蓝河操作系统比起上面两个操作系统更加成熟，其借助 AI 大模型能力实现了对多模态交互的支持，包括声音、图片、文字、视频、手势等。同时，其利用 Rust 的内存安全特性，保障了系统的内存安全和并发安全。但是其仍然有应用兼容性差、生态系统成熟度低等问题。

总体而言，蓝河操作系统在智能交互和安全性方面具有显著优势，但在应用兼容性和生态系统成熟度方面仍需进一步发展。
\subsection{本项目的主要创新点}

本项目希望能将Rust引入RT-Thread，一款由中国开源社区主导开发的实时物联网操作系统。其创新点主要有以下三点：

\begin{enumerate}
  \item 相比于Linux和Windows，RT-Thread是一款嵌入式操作系统。而嵌入式操作系统相对而言由于其系统的简单性可能会更容易面临安全性挑战。而使用Rust代替C语言将从源头上解决内存管理的安全性问题。
  \item 相比于蓝河操作系统、TockOS与Redox，RT-Thread拥有更成熟的生态环境与更好的兼容性。RT-Thread已经发展了16年，其对市场上主流的硬件架构都有着很好的支持，同时，其对在线软件包管理工具的支持又让其兼具了可拓展性和兼容性。
  \item RT-Thread系统完全开源，遵循Apache License 2.0开源许可协议，并且是中国社区主持的拥有完全知识产权的产品。对RT-Thread的开发和完善有助于我国开源社区生态的发展，有助于我国操作系统自主性的实现，具有重要的战略意义。
\end{enumerate}